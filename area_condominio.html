<!DOCTYPE html>
<html lang="pt-br">
<head>
Â  Â  <script type="module">
Â  Â  Â  Â  // ==================== ðŸ”¥ INÃCIO FIREBASE ðŸ”¥ ====================
Â  Â  Â  Â  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js";
Â  Â  Â  Â  import { getAnalytics, logEvent } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-analytics.js";
Â  Â  Â  Â  import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-database.js";
Â  Â  Â  Â  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-auth.js";
Â  Â  Â  Â  import { getAuth as getFirebaseAuth, signOut } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-auth.js";

Â  Â  Â  Â  import { app } from './firebase.js';

Â  Â  Â  Â  const analytics = getAnalytics(app);
Â  Â  Â  Â  const db = getDatabase(app);Â 
Â  Â  Â  Â  const authFirebase = getFirebaseAuth(app);Â 
Â  Â  Â  Â  const auth = getAuth(app);Â 

Â  Â  Â  Â  // Registra o evento de visualizaÃ§Ã£o da pÃ¡gina
Â  Â  Â  Â  logEvent(analytics, 'page_view');

Â  Â  Â  Â  onAuthStateChanged(auth, (user) => {
Â  Â  Â  Â  Â  Â  if (user) {
Â  Â  Â  Â  Â  Â  Â  Â  // UsuÃ¡rio estÃ¡ logado, pode continuar na pÃ¡gina
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  // UsuÃ¡rio nÃ£o estÃ¡ logado, redirecione para a pÃ¡gina de login
Â  Â  Â  Â  Â  Â  Â  Â  console.log("UsuÃ¡rio nÃ£o autenticado, redirecionando para login...");
Â  Â  Â  Â  Â  Â  Â  Â  window.location.href = 'index.html';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  // FunÃ§Ã£o para registrar acessos no Firebase com horÃ¡rio correto (UTC-3)
Â  Â  Â  Â  function logAccess(userCode, userName, apartment, accessedDocument) {
Â  Â  Â  Â  Â  Â  const now = new Date();
Â  Â  Â  Â  Â  Â  now.setHours(now.getHours() - 3);
Â  Â  Â  Â  Â  Â  const formattedDate = now.toISOString().replace('T', '_').split('.')[0];
Â  Â  Â  Â  Â  Â  let fileName = `${userName}_Acesso_apartamento_${apartment}_${accessedDocument}_${userCode}_${formattedDate}`;
Â  Â  Â  Â  Â  Â  fileName = fileName.replace(/[^a-zA-Z0-9_-]/g, '_');
Â  Â  Â  Â  Â  Â  const accessLog = {
Â  Â  Â  Â  Â  Â  Â  Â  userCode: userCode,
Â  Â  Â  Â  Â  Â  Â  Â  userName: userName,
Â  Â  Â  Â  Â  Â  Â  Â  apartment: `Acesso ao apartamento ${apartment}`,
Â  Â  Â  Â  Â  Â  Â  Â  accessedDocument: accessedDocument,
Â  Â  Â  Â  Â  Â  Â  Â  accessDate: now.toISOString()
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  const logRef = ref(db, `logs/${fileName}`);
Â  Â  Â  Â  Â  Â  set(logRef, accessLog)
Â  Â  Â  Â  Â  Â  Â  Â  .then(() => console.log("Log registrado com horÃ¡rio correto:", now.toISOString()))
Â  Â  Â  Â  Â  Â  Â  Â  .catch(error => console.error("Erro ao registrar log:", error));
Â  Â  Â  Â  }
Â  Â  Â  Â  window.logAccess = logAccess;
Â  Â  Â  Â Â 
Â  Â  Â  Â  // ============================================================================================
Â  Â  Â  Â  // AJUSTE: Mover a mensagem "Bem vindo(a): [nome]" para o parÃ¡grafo de manutenÃ§Ã£o
Â  Â  Â  Â  const nomeUsuario = localStorage.getItem('userName');
Â  Â  Â  Â  const welcomeMessageElement = document.getElementById('welcome-message'); 

Â  Â  Â  Â  if (nomeUsuario && welcomeMessageElement) {
Â  Â  Â  Â  Â  Â  // Insere o nome do usuÃ¡rio no inÃ­cio do texto existente do parÃ¡grafo
Â  Â  Â  Â  Â  Â  // Adiciona um <br> para que "Site em manutenÃ§Ã£o" fique na prÃ³xima linha
Â  Â  Â  Â  Â  Â  welcomeMessageElement.innerHTML = `Bem vindo(a): ${nomeUsuario}.<br>` + welcomeMessageElement.innerHTML;
Â  Â  Â  Â  }

Â  Â  Â  Â  // REMOVIDO: O cÃ³digo abaixo que inseria o span ao lado do botÃ£o Sair nÃ£o Ã© mais necessÃ¡rio
Â  Â  Â  Â  // const botaoSair = document.querySelector('.logout-button');
Â  Â  Â  Â  // if (nomeUsuario && botaoSair) {
Â  Â  Â  Â  // Â  const spanNomeUsuario = document.createElement('span');
Â  Â  Â  Â  // Â  spanNomeUsuario.textContent = 'Bem vindo(a): ' + nomeUsuario + '\u00A0\u00A0';
Â  Â  Â  Â  // Â  botaoSair.parentNode.insertBefore(spanNomeUsuario, botaoSair);
Â  Â  Â  Â  // }
Â  Â  Â  Â  // ============================================================================================

Â  Â  Â  Â  function sair() {
Â  signOut(authFirebase).then(() => {
Â  Â  console.log('UsuÃ¡rio desconectado');
Â  Â  localStorage.clear(); // Tentativa final para limpar todo o localStorage
Â  Â  window.location.href = 'index.html';
Â  }).catch((error) => {
Â  Â  console.error('Erro ao fazer logout:', error);
Â  });
}
window.sair = sair;
Â  Â  Â  Â  // ==================== ðŸ”¥ FIM FIREBASE ðŸ”¥ ====================
Â  Â  </script>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <link rel="stylesheet" href="styles.css?v=1.1">
Â  Â  <title>CondomÃ­nio T Lacerda - Boletos e Contas</title>
Â  Â  <script src="script.js" defer type="module"></script>
Â  Â  <style>
Â  Â  Â  Â  .logout-button {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  top: 10px;
Â  Â  Â  Â  Â  Â  right: 10px;
Â  Â  Â  Â  Â  Â  padding: 10px 15px;
Â  Â  Â  Â  Â  Â  background-color: #f44336;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  font-size: 1em;
Â  Â  Â  Â  }
Â  Â  Â  Â  .logout-button:hover {
Â  Â  Â  Â  Â  Â  background-color: #d32f2f;
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body>
Â  Â  <div id="painel-aviso" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 1001; overflow: auto;">
Â  Â  Â  <div style="background-color: #f9f9f9; max-width: 600px; margin: 15% auto; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.3); text-align: center;">
Â  Â  Â  Â  <h2>Aviso Importante</h2>
Â  Â  Â  Â  <hr>
Â  Â  Â  Â  <div id="aviso-texto" style="margin-bottom: 20px; text-align: left;">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  <button id="entendi-aviso" style="padding: 10px 20px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 1em;">Entendi</button>
Â  Â  Â  </div>
Â  Â  </div>
Â  Â  <button class="logout-button" onclick="sair()">Sair</button>
Â  Â  <header>
Â  Â  Â  Â  <img src="images/logo_cond.jpg" alt="Logo do CondomÃ­nio" class="logo">
Â  Â  </header>

Â  Â  <div class="container">
Â  Â  Â  Â  <section id="content">
Â  Â  Â  Â  </section>

Â  Â  Â  Â  <h1>CondomÃ­nio T Lacerda</h1>
Â  Â  Â  Â  <p id="welcome-message">Site em manutenÃ§Ã£o.<br>Agradecemos sua paciÃªncia.</p>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div class="apartment-section">
Â  Â  Â  Â  Â  Â  <button class="apartment-button" id="apto1" disabled onclick="loadFiles('apto1')">Apartamento 1</button>
Â  Â  Â  Â  Â  Â  <button class="apartment-button" id="apto101" disabled onclick="loadFiles('apto101')">Apartamento 101</button>
Â  Â  Â  Â  Â  Â  <button class="apartment-button" id="apto102" disabled onclick="loadFiles('apto102')">Apartamento 102</button>
Â  Â  Â  Â  Â  Â  <button class="apartment-button" id="apto201" disabled onclick="loadFiles('apto201')">Apartamento 201</button>
Â  Â  Â  Â  Â  Â  <button class="apartment-button" id="apto202" disabled onclick="loadFiles('apto202')">Apartamento 202</button>
Â  Â  Â  Â  Â  Â  <button class="apartment-button" id="apto301" disabled onclick="loadFiles('apto301')">Apartamento 301</button>
Â  Â  Â  Â  Â  Â  <button class="apartment-button" id="apto302" disabled onclick="loadFiles('apto302')">Apartamento 302</button>
Â  Â  Â  Â  Â  Â  <button class="apartment-button" id="apto401" disabled onclick="loadFiles('apto401')">Apartamento 401</button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <hr>
Â  Â  Â  Â  <div id="file-list-wrapper">
Â  Â  Â  Â  Â  <section id="file-container" class="file-box" style="display:none; opacity: 1; transition: opacity 0.5s; height: 300px; width: 300px; overflow: auto;">
Â  Â  Â  Â  Â  Â  <h2>Boletos do <span id="apartment-number"></span></h2>
Â  Â  Â  Â  Â  Â  <hr>
Â  Â  Â  Â  Â  Â  <ul id="file-list" style="color: black;">
Â  Â  Â  Â  Â  Â  </ul>
Â  Â  Â  Â  Â  </section>

Â  Â  Â  Â  Â  <section id="contas-container" class="file-box" style="display:none; opacity: 1; transition: opacity 0.5s; height: 300px; width: 300px; overflow: auto;">
Â  Â  Â  Â  Â  Â  <h2>TransparÃªncia</h2>
Â  Â  Â  Â  Â  Â  <hr>
Â  Â  Â  Â  Â  Â  <label for="ano-conta">Ano:</label>
Â  Â  Â  Â  Â  Â  <select id="ano-conta">
Â  Â  Â  Â  Â  Â  Â  <option value="2025" selected>2025</option>
Â  Â  Â  Â  Â  Â  </select><br><br>

Â  Â  Â  Â  Â  Â  <label for="mes-conta">MÃªs:</label>
Â  Â  Â  Â  Â  Â  <select id="mes-conta">
Â  Â  Â  Â  Â  Â  Â  <option value="">Selecione o mÃªs</option>
Â  Â  Â  Â  Â  Â  Â  <option value="1">Janeiro</option>
Â  Â  Â  Â  Â  Â  Â  <option value="2">Fevereiro</option>
Â  Â  Â  Â  Â  Â  Â  <option value="3">MarÃ§o</option>
Â  Â  Â  Â  Â  Â  Â  <option value="4">Abril</option>
Â  Â  Â  Â  Â  Â  Â  <option value="5">Maio</option>
Â  Â  Â  Â  Â  Â  Â  <option value="6">Junho</option>
Â  Â  Â  Â  Â  Â  Â  <option value="7">Julho</option>
Â  Â  Â  Â  Â  Â  Â  <option value="8">Agosto</option>
Â  Â  Â  Â  Â  Â  Â  <option value="9">Setembro</option>
Â  Â  Â  Â  Â  Â  Â  <option value="10">Outubro</option>
Â  Â  Â  Â  Â  Â  Â  <option value="11">Novembro</option>
Â  Â  Â  Â  Â  Â  Â  <option value="12">Dezembro</option>
Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  <ul id="contas-list" style="color: black;">
Â  Â  Â  Â  Â  Â  </ul>
Â  Â  Â  Â  Â  </section>
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  <section id="notifications-container" class="file-box" style="display: none; transition: opacity 0.5s, transform 0.3s ease, border-color 0.4s ease; height: 300px; width: 300px; overflow: auto;">
Â  Â  Â  Â  Â  Â  <h2>HistÃ³rico de notificaÃ§Ãµes</h2>
Â  Â  Â  Â  Â  Â  <hr>Â  Â Â 
Â  Â  Â  Â  Â  Â  <div id="notifications-list" style="color: black; white-space: pre-line;">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </section>

Â  Â  Â  Â  Â  <section id="documentos-container" class="file-box" style="display:none; opacity: 1; transition: opacity 0.5s; height: 300px; width: 300px; overflow: auto;">
Â  Â  Â  Â  Â  Â  <h2>Documentos</h2>
Â  Â  Â  Â  Â  Â  <hr>
Â  Â  Â  Â  Â  Â  <div id="documentos-list" style="color: black;">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </section>
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <hr>
Â  Â  Â  Â  Â  Â  Â  <div style="text-align: left;">
Â  Â  Â  Â  Â  Â  Â  Â  <img src="images/tokio_marine.jpg" width="328" height="78" alt="Imagem Tokio Marine">
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <hr>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <section id="viewer-container" style="display:none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.8); z-index: 1000; transition: opacity 0.5s;">
Â  Â  Â  Â  Â  <iframe id="file-viewer" style="width: 80%; height: 80%; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: white;"></iframe>
Â  Â  Â  Â  Â  <a id="download-button" style="position: absolute; top: 20px; right: 20px; color: white; text-decoration: none; padding: 10px; background-color: #007bff; border-radius: 5px;" download>Baixar</a>
Â  Â  Â  Â  Â  <button style="position: absolute; top: 20px; left: 20px; padding: 10px; background-color: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer;" onclick="document.getElementById('viewer-container').style.display='none'; setTimeout(() => document.getElementById('viewer-container').classList.remove('active'), 50);">Fechar</button>
Â  Â  Â  Â  </section>

Â  Â  Â  Â  Â  Â  Â  Â  <div style="text-align: center; margin-top: 20px;">
Â  Â  Â  Â  Â  <a href="#" onclick="openFileViewer('politicas/politica_uso.pdf'); logAccess({ apartment: localStorage.getItem('apartmentId'), downloadedFile: 'Visualizada PolÃ­tica de Uso' });">PolÃ­tica de Uso</a> <a href="#" onclick="openFileViewer('politicas/politica_privacidade.pdf'); logAccess({ apartment: localStorage.getItem('apartmentId'), downloadedFile: 'Visualizada PolÃ­tica de Privacidade' });">PolÃ­tica de Privacidade</a>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â Â  Â  Â  Â  <section id="login" style="display:none;">
Â  Â  Â  Â  Â  Â  <h2>Login</h2>
Â  Â  Â  Â  Â  Â  <form id="formularioLogin">
Â  Â  Â  Â  Â  Â  Â  Â  <label for="emailLogin">Email:</label><br>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="email" id="emailLogin" name="emailLogin" required><br><br>
Â  Â  Â  Â  Â  Â  Â  Â  <label for="senhaLogin">Senha:</label><br>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="password" id="senhaLogin" name="senhaLogin" required><br><br>
Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit">Entrar</button>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="mensagemLogin"></div>
Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  <p>NÃ£o tem uma conta? <a href="#" id="mostrarCadastro">Cadastre-se</a></p>
Â  Â  Â  Â  </section>

Â  Â  Â  Â  <section id="cadastro" style="display:none;">
Â  Â  Â  Â  Â  Â  <h2>Cadastro</h2>
Â  Â  Â  Â  Â  Â  <form id="formularioCadastro">
Â  Â  Â  Â  Â  Â  Â  Â  <label for="emailCadastro">Email:</label><br>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="email" id="emailCadastro" name="emailCadastro" required><br><br>
Â  Â  Â  Â  Â  Â  Â  Â  <label for="senhaCadastro">Senha:</label><br>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="password" id="senhaCadastro" name="senhaCadastro" required><br><br>
Â  Â  Â  Â  Â  Â  Â  Â  <label for="codigoAcesso">CÃ³digo de Acesso:</label><br>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="codigoAcesso" name="codigoAcesso" placeholder="Seu CÃ³digo de Acesso"><br><br>
Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit">Cadastrar</button>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="mensagemCadastro"></div>
Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  <p>JÃ¡ tem uma conta? <a href="#" id="mostrarLogin">FaÃ§a login</a></p>
Â  Â  Â  Â  </section>
Â  Â  </div>

Â  Â  <footer>
Â  Â  Â  Â  <p>&copy; 2025 Portal do CondomÃ­nio. Todos os direitos reservados.</p>
Â  Â  Â  Â  <p style="font-size: 0.8em;">CondomÃ­nio EdifÃ­cio T Lacerda.</p>
Â  Â  </footer>

Â  Â  <script type="module">
Â  Â  Â  import { showFiles } from './script.js';

Â  Â  Â  document.addEventListener('DOMContentLoaded', function() {
Â  Â  Â  Â  const apartmentId = localStorage.getItem('apartmentId');
Â  Â  Â  Â  if (apartmentId) {
Â  Â  Â  Â  Â  const aptoNumber = apartmentId.replace('apto', '');
Â  Â  Â  Â  Â  const apartmentButton = document.getElementById('apto' + aptoNumber);
Â  Â  Â  Â  Â  if (apartmentButton) {
Â  Â  Â  Â  Â  Â  apartmentButton.disabled = false;
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  });

Â  Â  Â  // FunÃ§Ã£o para ser chamada no onclick dos botÃµes
Â  Â  Â  window.loadFiles = function(apartment) {
Â  Â  Â  Â  showFiles(apartment);
Â  Â  Â  };
Â  Â  </script>
</body>
</html>
